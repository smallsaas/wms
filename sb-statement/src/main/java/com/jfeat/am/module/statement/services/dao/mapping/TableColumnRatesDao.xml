<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.jfeat.am.module.statement.services.dao.TableColumnRatesDao">

    <!--模糊查询设备信息-->


    <select id="queryValueOfColumn" resultType="String">
        select distinct ${columnName} from ${tableName};
    </select>

    <select id="getColumnRates" resultType="map">
        select count(${column}) as total,
        <foreach collection="columnValues" index="index" item="columnValue" open="" separator="," close="">
            sum( case when ${column}= #{columnValue} then 1 else 0 end) as ${columnValue}
        </foreach>
        from ${table};
    </select>

</mapper>
